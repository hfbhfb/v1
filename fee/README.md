### 修订
版本 | 修证人|详细描述 |      
------------ | ------------|------
v1.01 | 何发宝|修改了cdn被攻击成本不可控的预算 ( cdn服务商支持验证,基本阻挡了简单流量攻击(可默认不会受到攻击) )   |   
v1.02 | 何发宝| 增加短信成本   |
v1.03 | 何发宝| 修改阿里云slb内容,可使用于项目中. 实际上必须用,不能把https的计算放到一个节点上,无法支撑(只是通用性上很差,别人的云服务器没有相应的服务)   |





# 方案
类别 | 详细描述 |  费用计算    | 承载量 
------------ | ------------- | ------------|-------
带宽成本 | 一年(5M*2)  |  2550元 |  以峰值计算,(目标是平均每个用户只产生2KByte(20Kb)的数据),那么10Mb高峰时可以处理(10*1000(Kb)/2*10(Kb)=500, 最高峰一分钟可处理500*60=30000个人点餐)
主和从服务器成本 | 一年(3台)  |  789元(*3)=2367元 |   
动态生成服务器成本 | 一天开2小时,3台(1核2G)=3.6元  | 一年1314元  |   beego每个websocket连接估计会产生大量的内存,需要动态产生一些服务器以满足高峰时段的需求
CDN成本 | 0.29(https 0.36)元1G  | 预算2000元  |   微信小程序一定要做最大限度的缓存和提高缓存算法的命中率
短信成本 | 0.045每条  | 预算2000元  |   默认一般用户不会去手机绑定


结论:服务器相关费用一年约为 10221元. (cdn 支持下载凭证,这样安全性处理好的情况下,不用担心受到攻击的问题)


 


#阿里云弹性公网IP(按带宽)
类别 | 详细描述 |  费用计算    | 是否采用 | 理由
------------ | ------------- | ------------|--------|--------
1Mb | 一年  |  234元 | 
1Mb | 三年  |  703元 | 
5Mb | 一天  |  5.28元 | 
5Mb | 一个月  |  125元 | 
5Mb | 一年  |  1275元 | 建议(*2) | 自己开发测试使用带宽小点无所谓,上线应用要有预留带宽,不要算得太死 
10Mb | 一个月  |  525元 | 
10Mb | 一年  |  5355元 | 
20Mb | 一年  |  13515元 | 


结论:计费为非线性的,对于我们有相应技术能力的公司,需要把规则用好,用活,用足. 





# 阿里云服务器费用对比
类别 | 详细描述 |  费用计算    | 是否采用 | 理由
------------ | ------------- | ------------|--------|--------
1核1G | 一个月  |  49元 | 
1核1G | 一年  |  588元 |   看测试结果 | 
1核1G | 三年  |  1260元 |    | 
1核2G | 一个月  |  65.8元 | 
1核2G | 一年  |  789元 |   建议 |
1核2G | 三年  |  1692元 | 
2核4G | 一个月  | 141元 | 
2核4G | 一年  | 1696元 | 
2核4G | 三年  | 3636元 | 
1核1G | 一年,1Mb的公网带宽和ip  |  781元 | 考虑   | 不可或缺的成本(需要云主机和公网ip)
1核1G | 三年,1Mb的公网带宽和ip  |  1963元 |    | 

建议:一年的服务器,再加上一年5M的带宽



#阿里云弹性公网IP(按量)

类别 | 详细描述 |  费用计算    | 是否采用 | 理由
------------ | ------------- | ------------|--------|--------
1-100Mb |   | 0.8元1G | 有风险 |

结论: 不建议 如果设置20M的峰值,1小时拉满出口带宽的话,需要144块钱.




# 阿里云slb费用对比

类别 | 详细描述 |  费用计算    | 是否采用
------------ | ------------- | ------------|--------
负载均衡slb(1Mb) |   | 0.06元一个小时  | 测试
负载均衡slb(5Mb) |   | 0.22元一个小时  | 
负载均衡slb(10Mb) |   | 0.92元一个小时  |
负载均衡slb(20Mb) |   | 2.32元一个小时  |
负载均衡slb(40Mb) |   | 5.12元一个小时  |
负载均衡slb(100Mb) |   | 13.52元一个小时  |

总结:slb后面放置nginx(用以支持不同的host)
